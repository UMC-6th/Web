<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        h1 {
            position: fixed;
            top: 20px;
            right: 550px;
        }

        h5 {
            position: relative;
            top: 20px;
            text-align: left;
            right:95px;
        }

        .container {
            width: 500px;
            height: 550px;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            border: 1px solid lightgrey;
            border-radius: 5px;
            background-color:#DEECF3;
            position: absolute;
            /*  수직정렬  */
            top: 0;
            bottom: 0;
            /*  수평정렬  */
            left: 0;
            right: 0;
            margin: auto;
    }

        .account {
            margin: auto;
            border-radius: 3px;
            width: 250px;
            height: 30px;
            background-color: #DEECF3;
            border: 2px solid white;
    }

        .bttn{
            width: 200px;
            height: 20px;
            background-color: gray;
            border: 1px solid lightgrey;
            color: white;
        }

        .modal {
            position: absolute;
            background-color: #ffffff;
            border-color: black;
            width: 300px;
            height: 150px;
            padding: 45px;
    }
        .modalContainer{
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
    }
    </style>
</head>

<body>
    <script>
        document.body.style.backgroundColor = "lightblue";

        window.addEventListener('DOMContentLoaded', function () {  //addEventListenr('이벤트',함수명)
            let myId = document.getElementById("userName");
            let myIdError = document.getElementById("userNameError");
            let myIdPass = document.getElementById("userNamePass");
            let myEmail = document.getElementById("userEmail");
            let myEmailError = document.getElementById("userEmailError");
            let myEmailPass = document.getElementById("userEmailPass");
            let myAge = document.getElementById("userAge");
            let myAgeError = document.getElementById("userAgeError");
            let myAgePass = document.getElementById("userAgePass");
            let myPassword = document.getElementById("userPassword");
            let myPasswordError = document.getElementById("userPasswordError");
            let myPasswordPass = document.getElementById("userPasswordPass");
            let myPassword2 = document.getElementById("userPassword2");
            let myPasswordError2 = document.getElementById("userPasswordError2");
            let myPasswordPass2 = document.getElementById("userPasswordPass2");
            let submitButton = document.querySelector('input[type="submit"]');

            myId.addEventListener('input', function (event) {
                const validLetter = /^[ㄱ-ㅎ|가-힣|a-z|A-Z]+$/;
                if (!validLetter.test(event.target.value)) {
                    myIdError.textContent = '문자열만 입력 가능합니다.';
                    myIdError.style.display = 'block';
                } else {
                    myIdError.style.display = 'none';

                }
            });

            myEmail.addEventListener('input', function (event) {
                const regex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                if (!regex.test(event.target.value)) {
                    myEmailError.textContent = "올바른 이메일 형식이 아닙니다.";
                    myEmailError.style.display = "block";
                } else {
                    myEmailError.style.display = "none";
                }
            });

        /*    myAge.addEventListener('input', function (event) {
                const regex = /^(0|[1-9]\d*)$/;
                if (!regex.test(event.target.value)) {
                    myAgeError.textContent = "나이는 숫자 형식이어야 합니다.";
                    myAgeError.style.display = "block"; //블록 요소를 가지며, 가로값이 100%줄바꿈으로 일어남
                } else if(event.target.value<=19){
                    myAgeError.textContent = "19세 이상만 가입가능합니다.";
                    myAgeError.style.display = "block";
                }else if (parseInt(event.target.value) <  0) {
                    myAgeError.textContent = "나이는 음수가 될 수 없습니다.";
                    myAgeError.style.display = "block";
                }else if (event.target.value.includes('.')) {
                    myAgeError.textContent = "나이는 소수가 될 수 없습니다.";
                    myAgeError.style.display = "block";
                }
                else {
                    myAgeError.style.display = "none"; //에러 표시 아예 없어짐
                }
               });
*/
            myAge.addEventListener('input', function (event) {
                const age = parseFloat(event.target.value);
                if (isNaN(age)) {
                    myAgeError.textContent = "나이는 숫자 형식이어야 합니다.";
                    myAgeError.style.display = "block";
                } else if (age < 0) {
                    myAgeError.textContent = "나이는 음수가 될 수 없습니다.";
                    myAgeError.style.display = "block";
                } else if (age <= 19) {
                    myAgeError.textContent = "19세 이상만 가입 가능합니다.";
                    myAgeError.style.display = "block";
                } else if (age !== Math.floor(age)) {
                    myAgeError.textContent = "나이는 소수가 될 수 없습니다.";
                    myAgeError.style.display = "block";
                } else {
                    myAgeError.style.display = "none";
                }
            });

            myPassword.addEventListener('input', function (event) {
                const regex = /^(?=.*[a-zA-Z])(?=.*[\d@$!%*?&])[a-zA-Z\d@$!%*?&]{4,12}$/;
                if (event.target.value.length < 4) {
                    myPasswordError.textContent = "비밀번호는 최소 4자리 이상이어야 합니다.";
                    myPasswordError.style.display = "block";
                } else if (event.target.value.length >= 13) {
                    myPasswordError.textContent = "비밀번호는 최대 12자리까지 가능합니다.";
                    myPasswordError.style.display = "block";
                } else if (!regex.test(event.target.value)) {
                    myPasswordError.textContent = "영어, 숫자, 특수문자를 모두 조합해서 비밀번호를 작성해야 합니다.";
                    myPasswordError.style.display = "block";
                } else {
                    myPasswordError.style.display = "none";
                }
            });

            myPassword2.addEventListener('input',function(event){
                if(event.target.value!==myPassword.value){
                    myPasswordError2.textContent = "비밀번호가 일치하지 않습니다.";
                    myPasswordError2.style.display = "block";
                }else{
                    myPasswordError2.style.display = "none";
                }
            });

/*            submitButton.addEventListener('click', function (event) {
                event.preventDefault(); // 기본 제출 동작 막기
                let userNameValue = myId.value.trim();
                let userEmailValue = myEmail.value.trim();
                let userAgeValue = myAge.value.trim();
                let userPasswordValue = myPassword.value.trim();
                let userPasswordValue2 = myPassword2.value.trim();
                if (!userNameValue) {
                    myIdError.textContent = '이름은 필수입력입니다.';
                    myIdError.style.display = 'block';
                    event.preventDefault();
                }else {
                    myIdError.style.display = 'none';
                    myIdPass.textContent = '멋진 이름이네요!';
                    myIdPass.style.display = 'block';
        }
                if (!userEmailValue) {
                    myEmailError.textContent = '이메일은 필수입력입니다.';
                    myEmailError.style.display = 'block';
                    event.preventDefault();
                }else {
                    myEmailError.style.display = 'none';
                    myEmailPass.textContent = '올바른 이메일입니다.';
                    myEmailPass.style.display = 'block';
        }
                if (!userAgeValue) {
                    myAgeError.textContent = '나이는 필수입력입니다.';
                    myAgeError.style.display = 'block';
                    event.preventDefault(); //키입력이 입력되는것방지
                }else {
                    myAgeError.style.display = 'none';
                    myAgePass.textContent = '올바른 나이입니다.';
                    myAgePass.style.display = 'block';
        }
                if (!userPasswordValue) {
                    myPasswordError.textContent = '비밀번호는 필수입력입니다.';
                    myPasswordError.style.display = 'block';
                    event.preventDefault();
                } else {
                    myPasswordError.style.display = 'none';
                    myPasswordPass.textContent = '올바른 비밀번호입니다.';
                    myPasswordPass.style.display = 'block';
        }
                if(!userPasswordValue2){
                    myPasswordError2.textContent = "비밀번호확인은 필수입력입니다.";
                    myPasswordError2.style.display = "block";
                    event.preventDefault();
            }else{
                myPasswordError2.style.display="none";
                myPasswordPass2.textContent = "비밀번호가 일치합니다";
                myPasswordPass2.style.display = "block";
            }
            
        
    });
        });
        */
        submitButton.addEventListener('click', function (event) {
            event.preventDefault(); // 기본 제출 동작 막기
            if (validateForm()) {
                const modall = document.querySelector(".modalContainer");
                modall.style.display = "flex";
    }
});
        const closeButton = document.getElementById("close");
        const modall = document.querySelector(".modalContainer");
        closeButton.addEventListener('click', function () {
            modall.style.display = "none"; // 모달 닫기
        });
        function validateForm() {
                let isValid = true;
                let userNameValue = myId.value.trim();
                let userEmailValue = myEmail.value.trim();
                let userAgeValue = myAge.value.trim();
                let userPasswordValue = myPassword.value.trim();
                let userPasswordValue2 = myPassword2.value.trim();

            const validLetter = /^[ㄱ-ㅎ|가-힣|a-z|A-Z]+$/;
            if(userNameValue === ""){
                myIdError.textContent = '필수입력항목입니다.';
                myIdError.style.display = 'block';
                isValid = false;
            }
            else if (!validLetter.test(myId.value.trim())) {
                myIdError.textContent = '문자열만 입력 가능합니다.';
                myIdError.style.display = 'block';
                isValid = false;
            } else {
                myIdError.style.display = 'none';
                myIdPass.textContent = '멋진 이름이네요!';
                myIdPass.style.display = 'block';
            }

            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if( userEmailValue===""){
                myEmailError.textContent = "필수입력항목입니다.";
                myEmailError.style.display = "block";
                isValid = false;
            }
            else if (!emailRegex.test(myEmail.value.trim())) {
                myEmailError.textContent = "올바른 이메일 형식이 아닙니다.";
                myEmailError.style.display = "block";
                isValid = false;
            } else {
                myEmailError.style.display = "none";
                myEmailPass.textContent = '올바른 이메일입니다.';
                myEmailPass.style.display = 'block';
            }
            const age = parseFloat(myAge.value.trim());
            if(userAgeValue===""){
                myAgeError.textContent = "나이는 필수입력입니다.";
                myAgeError.style.display = "block";
                isValid = false;
            }
            else if (isNaN(age) || age < 0 || age <= 19 || age !== Math.floor(age)) {
                if (isNaN(age)) {
                    myAgeError.textContent = "나이는 숫자 형식이어야 합니다.";
                } else if (age < 0) {
                    myAgeError.textContent = "나이는 음수가 될 수 없습니다.";
                } else if (age <= 19) {
                    myAgeError.textContent = "19세 이상만 가입 가능합니다.";
                } else if (age !== Math.floor(age)) {
                    myAgeError.textContent = "나이는 소수가 될 수 없습니다.";
                }
                myAgeError.style.display = "block";
                isValid = false;
            } else {
                myAgeError.style.display = "none";
                myAgePass.textContent = '올바른 나이입니다.';
                myAgePass.style.display = 'block';
            }

            // 비밀번호 유효성 검사
            const regex = /^(?=.*[a-zA-Z])(?=.*[!@#$%^*+=-])(?=.*[0-9]).{4,12}$/;
            let myPasswordError2 = document.getElementById("userPasswordError2");
            if(userPasswordValue=""){
                myPasswordError.textContent = "비밀번호는 설정은 필수입니다";
                myPasswordError.style.display = "block";
                isValid = false;
            }
            else if (myPassword.value.length < 4) {
                myPasswordError.textContent = "비밀번호는 최소 4자리 이상이어야 합니다.";
                myPasswordError.style.display = "block";
                isValid = false;
            } else if (myPassword.value.length >= 13) {
                myPasswordError.textContent = "비밀번호는 최대 12자리까지 가능합니다.";
                myPasswordError.style.display = "block";
                isValid = false;
            } else if (!regex.test(myPassword.value)) {
                myPasswordError.textContent = "영어, 숫자, 특수문자를 모두 조합해서 비밀번호를 작성해야 합니다.";
                myPasswordError.style.display = "block";
                isValid = false;
            } else {
                myPasswordError.style.display = "none";
                myPasswordPass.textContent = '올바른 비밀번호입니다.';
                myPasswordPass.style.display = 'block';
            }

            // 비밀번호 확인 일치 여부 검사
            if(userPasswordValue2===""){
                myPasswordError2.textContent = "비밀번호는 필수입력입니다";
                myPasswordError2.style.display = "block";
                isValid = false;
            }
            else if ((myPassword2.value != myPassword.value)) {
                myPasswordError2.textContent = "비밀번호가 일치하지 않습니다.";
                myPasswordError2.style.display = "block";
                isValid = false;
            } else {
                myPasswordError2.style.display = "none";
                myPasswordPass2.textContent = "비밀번호가 일치합니다";
                myPasswordPass2.style.display = "block";
            }

            return isValid;
        }
        });


    </script>

    <form action="/submit" method="post">
        <div class="container">

                <div class="py-5 text-center">
                    <h1>회원가입</h1>
                </div>
                <hr>
                <h5>이름</h5>
                <input type="text" id="userName" placeholder="Enter name" class="account" />
                <div id="userNameError" style="display: none; color: red;font-size: small;"></div>
                <div id="userNamePass" style="display: none; color: green;font-size: small;"></div>
                <h5>이메일</h5>
                <input type="email" id="userEmail" placeholder="Enter your email"  class="account"/>
                <div id="userEmailError" style="display: none; color: red;font-size: small;"></div>
                <div id="userEmailPass" style="display: none; color: green;font-size: small;"></div>
                <h5>나이</h5>
                <input type="text" id="userAge" placeholder="Enter age"  class="account">
                <div id="userAgeError" style="display: none; color: red;font-size: small;"></div>
                <div id="userAgePass" style="display: none; color: green;font-size: small;"></div>
                <h5>비밀번호</h5>
                <input type="password" id="userPassword" placeholder="Enter password"  class="account">
                <div id="userPasswordError" style="display: none; color: red; font-size: small;"></div>
                <div id="userPasswordPass" style="display: none; color: green;font-size: small;"></div>
                <h5>비밀번호 확인</h5>
                <input type="password" id="userPassword2" placeholder="Enter password"  class="account">
                <div id="userPasswordError2" style="display: none;color: red;font-size: small;"></div>
                <div id="userPasswordPass2" style="display: none;color: green;font-size: small;"></div>
                <input type="submit" value="가입하기" class="bttn"/>
            </div>
        </div>
    </form> 

        <div class="modalContainer" style="display: none;">
            <div class ="modal">
            <h3>가입성공!</h3>

            <h3>UMC회원가입을 축하합니다!!</h3>
            <button id="close">닫기</button>

            </div>
        </div>


</body>
</html>